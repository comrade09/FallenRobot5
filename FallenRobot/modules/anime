import requests
from Himawari import pgram as pbot
from pyrogram import filters, Client
from pyrogram.types import Message
from pyrogram.enums import ParseMode
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton , CallbackQuery , Message
  
def shorten(description):
    msg = ""
    if len(description) > 200:
        description = description[0:200] + "..."
        msg += f"{description}"
    else:
        msg += f"{description}"
    return msg
 
@bot.on_message(filters.command("character"), group=977)
async def genshin_character(_: Client, message: Message):
    text = "".join(message.text.split(" ")[1:])
    if len(text) == 0:
        return await message.reply_text(
            "Cannot reply to empty message.", parse_mode=ParseMode.MARKDOWN
        )

    m= await message.reply_text("Gathering Infromation....", parse_mode=ParseMode.MARKDOWN)
    response = requests.get("https://api.safone.dev/anime/character?query=" + text)
    if response.status_code == 200:
        data = response.json()
        data_ph = response.json()['image']
        imx = data_ph ['medium']
        desc = data ['description']
        mxg = shorten(desc)
        gender = data ['gender']
        height = data ['height']
        age = data ['age']
        photo = imx
        genshin_char = f"""

**Age:** {age}      
**Description :**{mxg}
**Height:** {height} 
**Gender:** {gender} 


            """

    await message.reply_photo (photo , caption= genshin_char, parse_mode=ParseMode.MARKDOWN )
   
__mod_name__ = "Anime"

__help__ = """

Command '/gicharacter'
eg. /gicharacter Amber

 """
